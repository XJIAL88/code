{"version":3,"sources":["webpack:///src/views/activity/edit.vue","webpack:///./src/views/activity/edit.vue?18a3","webpack:///./src/views/activity/edit.vue"],"names":["edit","data","form","name","type","startAt","endAt","numberTotal","numberDaily","new","rule","newDaylimit","resource","rules","required","message","trigger","groupId","props","label","value","children","typeList","groupList","categoryList","isFirst","list","mounted","this","initInfo","getCategoryList","methods","renderFirst","_this","$createElement","$bus","$emit","c","h","attrs","size","on","click","next","goBack","renderBreadCrumbAction","_this2","submitForm","Object","utils","$nextTick","getGroupList","_this3","api","post","then","res","dataList","_this4","updateDay","_this5","$prompt","confirmButtonText","cancelButtonText","inputPattern","inputErrorMessage","_ref","catch","$message","_this6","$refs","validate","valid","_this7","length","flag","forEach","item","checkResult","check","showTips","obj","resourceId","resourceName","categoryId","category","grantType","number","push","$router","back","changeGroup","val","_this8","id","gorupTitle","title","addItem","resourceList","delItem","index","splice","changeCategory","row","console","log","i","son","ele","info","getResurceList","changeResource","params","platform","status","callType","pageSize","pageNumber","loading","text","$alert","callback","action","activity_edit","render","_vm","_h","_c","_self","staticClass","ref","model","label-width","span","prop","$$v","$set","expression","_v","start-at","end-at","update:startAt","$event","update:endAt","placeholder","slot","staticStyle","margin-top","_l","key","_s","rows","_e","padding","font-size","width","margin-left","border","align","scopedSlots","_u","fn","scope","clearable","options","show-all-levels","change","$index","icon","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/0.7c22c8b2c82c95a75986.js","sourcesContent":["<template>\r\n    <div class=\"activity-edit\">\r\n        <el-form :model=\"form\" ref=\"form\" label-width=\"100px\" :rules=\"rules\" v-if=\"isFirst\">\r\n            <el-row class=\"form-width\">\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"活动名称\" prop=\"name\">\r\n                        <el-input v-model=\"form.name\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"活动时间\" prop=\"startAt\">\r\n                        <FormDatetimeRange :start-at.sync=\"form.startAt\" :end-at.sync=\"form.endAt\"></FormDatetimeRange>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"抽奖次数\" prop=\"status\" class=\"draw-count\">\r\n                        <el-input v-model=\"form.numberTotal\" placeholder=\"无限\">\r\n                            <template slot=\"prepend\">每用户共可参加</template>\r\n                            <template slot=\"append\">次</template>\r\n                        </el-input>\r\n                        <el-input\r\n                            v-model=\"form.numberDaily\"\r\n                            style=\"margin-top:15px\"\r\n                            placeholder=\"无限\"\r\n                        >\r\n                            <template slot=\"prepend\">每用户每天可参加</template>\r\n                            <template slot=\"append\">次</template>\r\n                        </el-input>\r\n                    </el-form-item>\r\n                </el-col>\r\n\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"活动类型\" prop=\"status\">\r\n                        <el-select v-model=\"form.type\" placeholder=\"请选择\">\r\n                            <el-option\r\n                                v-for=\"item in typeList\"\r\n                                :key=\"item.value\"\r\n                                :label=\"item.label\"\r\n                                :value=\"item.value\"\r\n                            ></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <!-- <el-form-item label=\"活动范围\" prop=\"groupId\">\r\n                        <el-select v-model=\"form.groupId\" placeholder=\"请选择\" @change=\"changeGroup\">\r\n                            <el-option\r\n                                v-for=\"item in groupList\"\r\n                                :key=\"item.id\"\r\n                                :label=\"item.title\"\r\n                                :value=\"item.id\"\r\n                            ></el-option>\r\n                        </el-select>\r\n                    </el-form-item>-->\r\n                    <el-form-item label=\"新人专享\" prop=\"new\">\r\n                        <el-switch v-model=\"form.new\"></el-switch>（新人：注册\r\n                        <el-button type=\"text\" @click=\"updateDay\">{{form.newDaylimit}}</el-button>天内的用户）\r\n                    </el-form-item>\r\n                </el-col>\r\n            </el-row>\r\n            <el-row>\r\n                <el-col :span=\"16\">\r\n                    <el-form-item label=\"活动规则\">\r\n                        <el-input v-model=\"form.rule\" type=\"textarea\" :rows=\"4\"></el-input>\r\n                    </el-form-item>\r\n                </el-col>\r\n            </el-row>\r\n        </el-form>\r\n        <div v-if=\"!isFirst\">\r\n            <div style=\"padding:10px 30px;font-size:16px;\">申请资源：</div>\r\n            <el-table :data=\"list\" border style=\"width:721px;margin-left:30px\">\r\n                <el-table-column prop=\"categoryId\" label=\"资源类型\" width=\"180\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-cascader\r\n                            clearable\r\n                            :options=\"categoryList\"\r\n                            v-model=\"scope.row.categoryId\"\r\n                            @change=\"changeCategory(scope.row)\"\r\n                            :props=\"props\"\r\n                            :show-all-levels=\"false\"\r\n                        ></el-cascader>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"name\" label=\"资源名称\" width=\"180\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-select\r\n                            v-model=\"scope.row.resourceId\"\r\n                            clearable\r\n                            placeholder=\"请选择\"\r\n                            @change=\"changeResource(scope.row)\"\r\n                        >\r\n                            <el-option\r\n                                v-for=\"item in scope.row.resourceList\"\r\n                                :key=\"item.id\"\r\n                                :label=\"item.name\"\r\n                                :value=\"item.id\"\r\n                            ></el-option>\r\n                        </el-select>\r\n                    </template>\r\n                </el-table-column>\r\n                <!-- <el-table-column prop=\"canApply\" label=\"可申请总数量\" width=\"180\" align=\"center\"></el-table-column> -->\r\n                <el-table-column prop=\"number\" label=\"申请数量\" width=\"180\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-input v-model=\"scope.row.number\" placeholder=\"请输入\" type=\"number\"></el-input>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"操作\" width=\"180\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button type=\"text\" @click=\"delItem(scope.$index)\">删除</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <el-button\r\n                type=\"primary\"\r\n                icon=\"el-icon-plus\"\r\n                style=\"margin-left:30px;margin-top:15px\"\r\n                @click=\"addItem\"\r\n            >添加资源</el-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport api from \"@/api\";\r\nimport {\r\n    sessionStorageSet,\r\n    sessionStorageGet,\r\n    sessionStorageRemove\r\n} from \"@/utils\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            form: {\r\n                name: \"\",\r\n                type: 1,\r\n                startAt: \"\",\r\n                endAt: \"\",\r\n                numberTotal: \"\",\r\n                numberDaily: \"\",\r\n                new: false,\r\n                rule: \"\",\r\n                // groupId: \"\",\r\n                // gorupTitle: \"\",\r\n                newDaylimit: 30,\r\n                resource: []\r\n            },\r\n            rules: {\r\n                name: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入活动名称\",\r\n                        trigger: \"blur\"\r\n                    }\r\n                ],\r\n                startAt: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入活动时间\",\r\n                        trigger: \"blur\"\r\n                    }\r\n                ],\r\n                groupId: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入活动范围\",\r\n                        trigger: \"blur\"\r\n                    }\r\n                ]\r\n            },\r\n            props: {\r\n                label: \"title\",\r\n                value: \"id\",\r\n                children: \"son\"\r\n            },\r\n            typeList: [\r\n                {\r\n                    value: 1,\r\n                    label: \"开门抽奖\"\r\n                }\r\n            ],\r\n            groupList: [],\r\n            categoryList: [],\r\n            isFirst: true,\r\n            list: []\r\n        };\r\n    },\r\n    mounted() {\r\n        this.initInfo();\r\n        // this.getGroupList();\r\n        this.getCategoryList();\r\n    },\r\n    methods: {\r\n        renderFirst() {\r\n            this.$bus.$emit(\"changeBreadCrumbAction\", (c, h) => {\r\n                return h(\"div\", {}, [\r\n                    <el-button size=\"medium\" type=\"primary\" onClick={this.next}>\r\n                        下一步\r\n                    </el-button>,\r\n                    <el-button size=\"medium\" onClick={this.goBack}>\r\n                        取消\r\n                    </el-button>\r\n                ]);\r\n            });\r\n        },\r\n        renderBreadCrumbAction() {\r\n            this.$bus.$emit(\"changeBreadCrumbAction\", (c, h) => {\r\n                return h(\"div\", {}, [\r\n                    <el-button\r\n                        size=\"medium\"\r\n                        type=\"primary\"\r\n                        onClick={this.submitForm}\r\n                    >\r\n                        提交审批\r\n                    </el-button>,\r\n                    <el-button size=\"medium\" onClick={this.goBack}>\r\n                        取消\r\n                    </el-button>\r\n                ]);\r\n            });\r\n        },\r\n        initInfo() {\r\n            let form = sessionStorageGet(\"activityInfo\");\r\n            if (form) {\r\n                this.form = form;\r\n                this.isFirst = false;\r\n                this.$nextTick(this.renderBreadCrumbAction);\r\n            } else {\r\n                this.$nextTick(this.renderFirst);\r\n            }\r\n        },\r\n        getGroupList() {\r\n            api.post(\"activityGroupGetList\").then(res => {\r\n                this.groupList = res.data.dataList;\r\n            });\r\n        },\r\n        getCategoryList() {\r\n            api.post(\"resourceCategoryList\").then(res => {\r\n                this.categoryList = res.data.dataList;\r\n            });\r\n        },\r\n        updateDay() {\r\n            this.$prompt(\"请输入天数\", \"提示\", {\r\n                confirmButtonText: \"确定\",\r\n                cancelButtonText: \"取消\",\r\n                inputPattern: /^[1-9][0-9]{0,14}$/,\r\n                inputErrorMessage: \"请输入整数\"\r\n            })\r\n                .then(({ value }) => {\r\n                    this.form.newDaylimit = value;\r\n                })\r\n                .catch(() => {\r\n                    this.$message({\r\n                        type: \"info\",\r\n                        message: \"取消输入\"\r\n                    });\r\n                });\r\n        },\r\n        next() {\r\n            this.$refs.form.validate(valid => {\r\n                if (valid) {\r\n                    sessionStorageSet(\"activityInfo\", this.form);\r\n                    this.isFirst = false;\r\n                    this.$nextTick(this.renderBreadCrumbAction);\r\n                } else {\r\n                    return false;\r\n                }\r\n            });\r\n        },\r\n        submitForm() {\r\n            let resource = [];\r\n            if (this.list.length == 0) {\r\n                this.showTips(\"请添加资源\");\r\n                return;\r\n            }\r\n            let flag = false;\r\n            this.list.forEach(item => {\r\n                let checkResult = this.check(item);\r\n                if (checkResult) {\r\n                    this.showTips(checkResult);\r\n                    flag = true;\r\n                    return;\r\n                }\r\n                let obj = {\r\n                    resourceId: item.resourceId,\r\n                    resourceName: item.resourceName,\r\n                    categoryId: item.categoryId[item.categoryId.length - 1],\r\n                    category: item.category,\r\n                    grantType: 1,\r\n                    number: item.number\r\n                };\r\n                resource.push(obj);\r\n            });\r\n            if (flag) return;\r\n            this.form.resource = resource;\r\n            api.post(\"activityInsert\", this.form).then(res => {\r\n                this.goBack();\r\n            });\r\n        },\r\n        goBack() {\r\n            sessionStorageRemove(\"activityInfo\");\r\n            this.$router.back();\r\n        },\r\n        changeGroup(val) {\r\n            this.groupList.forEach(item => {\r\n                if (item.id == val) {\r\n                    this.form.gorupTitle = item.title;\r\n                }\r\n            });\r\n        },\r\n        addItem() {\r\n            let obj = {\r\n                categoryId: [],\r\n                category: \"\",\r\n                number: \"\",\r\n                resourceList: [],\r\n                resourceId: \"\",\r\n                resourceName: \"\",\r\n                grantType: 1\r\n            };\r\n            this.list.push(obj);\r\n        },\r\n        delItem(index) {\r\n            this.list.splice(index, 1);\r\n        },\r\n        changeCategory(row) {\r\n            console.log(row);\r\n            let val = row.categoryId;\r\n            let length = val.length;\r\n            if (length) {\r\n                for (let i = 0; i < val.length; i++) {\r\n                    this.categoryList.forEach(item => {\r\n                        if (item.id == val[0]) {\r\n                            if (length == 1) {\r\n                                row.category = item.title;\r\n                            } else {\r\n                                item.son.forEach(ele => {\r\n                                    if (ele.id == val[1]) {\r\n                                        if (length == 2) {\r\n                                            row.category = ele.title;\r\n                                        } else {\r\n                                            ele.son.forEach(info => {\r\n                                                if (info.id == val[2]) {\r\n                                                    row.category = info.title;\r\n                                                }\r\n                                            });\r\n                                        }\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            } else {\r\n                row.category = \"\";\r\n            }\r\n            row.resourceId = \"\";\r\n            row.resourceName = \"\";\r\n            // row.canApply = null;\r\n            row.number = \"\";\r\n            this.getResurceList(row);\r\n        },\r\n        changeResource(row) {\r\n            if (row.resourceId) {\r\n                row.resourceList.forEach(item => {\r\n                    if (item.id == row.resourceId) {\r\n                        row.resourceName = item.name;\r\n                        // row.canApply = item.quantity - item.used - item.freeze;\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        getResurceList(row) {\r\n            let params = {\r\n                category: \"\",\r\n                categoryId: row.categoryId[row.categoryId.length - 1],\r\n                platform: \"\",\r\n                name: \"\",\r\n                status: 1,\r\n                grantType: \"\",\r\n                callType: \"\",\r\n                pageSize: 1000,\r\n                pageNumber: 1\r\n            };\r\n            api.post(\"resourceGetList\", params, { loading: false }).then(\r\n                res => {\r\n                    row.resourceList = res.data.dataList;\r\n                }\r\n            );\r\n        },\r\n        check(item) {\r\n            if (!item.category) {\r\n                return \"请选择资源类型\";\r\n            }\r\n            if (!item.resourceId) {\r\n                return \"请选择资源\";\r\n            }\r\n            if (!item.number) {\r\n                return \"请输入申请数量\";\r\n            }\r\n            // if (parseInt(item.number) > parseInt(item.canApply)) {\r\n            //     return \"申请数量不能大于可申请数量\";\r\n            // }\r\n            return \"\";\r\n        },\r\n        showTips(text) {\r\n            this.$alert(text, \"提示\", {\r\n                type: \"warning\",\r\n                confirmButtonText: \"确定\",\r\n                callback: action => {}\r\n            });\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.activity-edit {\r\n    padding: 10px 0;\r\n    /deep/ .el-input-group__append,\r\n    /deep/ .el-input-group__prepend {\r\n        background: #fff;\r\n    }\r\n    .draw-count {\r\n        /deep/ .el-input__inner {\r\n            // border-left: 0;\r\n            // border-right: 0;\r\n        }\r\n    }\r\n    .form-width {\r\n        /deep/ .el-form-item__content {\r\n            width: 400px;\r\n        }\r\n    }\r\n}\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/activity/edit.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"activity-edit\"},[(_vm.isFirst)?_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"label-width\":\"100px\",\"rules\":_vm.rules}},[_c('el-row',{staticClass:\"form-width\"},[_c('el-col',{attrs:{\"span\":12}},[_c('el-form-item',{attrs:{\"label\":\"活动名称\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"活动时间\",\"prop\":\"startAt\"}},[_c('FormDatetimeRange',{attrs:{\"start-at\":_vm.form.startAt,\"end-at\":_vm.form.endAt},on:{\"update:startAt\":function($event){_vm.$set(_vm.form, \"startAt\", $event)},\"update:endAt\":function($event){_vm.$set(_vm.form, \"endAt\", $event)}}})],1),_vm._v(\" \"),_c('el-form-item',{staticClass:\"draw-count\",attrs:{\"label\":\"抽奖次数\",\"prop\":\"status\"}},[_c('el-input',{attrs:{\"placeholder\":\"无限\"},model:{value:(_vm.form.numberTotal),callback:function ($$v) {_vm.$set(_vm.form, \"numberTotal\", $$v)},expression:\"form.numberTotal\"}},[_c('template',{slot:\"prepend\"},[_vm._v(\"每用户共可参加\")]),_vm._v(\" \"),_c('template',{slot:\"append\"},[_vm._v(\"次\")])],2),_vm._v(\" \"),_c('el-input',{staticStyle:{\"margin-top\":\"15px\"},attrs:{\"placeholder\":\"无限\"},model:{value:(_vm.form.numberDaily),callback:function ($$v) {_vm.$set(_vm.form, \"numberDaily\", $$v)},expression:\"form.numberDaily\"}},[_c('template',{slot:\"prepend\"},[_vm._v(\"每用户每天可参加\")]),_vm._v(\" \"),_c('template',{slot:\"append\"},[_vm._v(\"次\")])],2)],1)],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":12}},[_c('el-form-item',{attrs:{\"label\":\"活动类型\",\"prop\":\"status\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.form.type),callback:function ($$v) {_vm.$set(_vm.form, \"type\", $$v)},expression:\"form.type\"}},_vm._l((_vm.typeList),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}))],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"新人专享\",\"prop\":\"new\"}},[_c('el-switch',{model:{value:(_vm.form.new),callback:function ($$v) {_vm.$set(_vm.form, \"new\", $$v)},expression:\"form.new\"}}),_vm._v(\"（新人：注册\\n                    \"),_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":_vm.updateDay}},[_vm._v(_vm._s(_vm.form.newDaylimit))]),_vm._v(\"天内的用户）\\n                \")],1)],1)],1),_vm._v(\" \"),_c('el-row',[_c('el-col',{attrs:{\"span\":16}},[_c('el-form-item',{attrs:{\"label\":\"活动规则\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":4},model:{value:(_vm.form.rule),callback:function ($$v) {_vm.$set(_vm.form, \"rule\", $$v)},expression:\"form.rule\"}})],1)],1)],1)],1):_vm._e(),_vm._v(\" \"),(!_vm.isFirst)?_c('div',[_c('div',{staticStyle:{\"padding\":\"10px 30px\",\"font-size\":\"16px\"}},[_vm._v(\"申请资源：\")]),_vm._v(\" \"),_c('el-table',{staticStyle:{\"width\":\"721px\",\"margin-left\":\"30px\"},attrs:{\"data\":_vm.list,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"categoryId\",\"label\":\"资源类型\",\"width\":\"180\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-cascader',{attrs:{\"clearable\":\"\",\"options\":_vm.categoryList,\"props\":_vm.props,\"show-all-levels\":false},on:{\"change\":function($event){_vm.changeCategory(scope.row)}},model:{value:(scope.row.categoryId),callback:function ($$v) {_vm.$set(scope.row, \"categoryId\", $$v)},expression:\"scope.row.categoryId\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"资源名称\",\"width\":\"180\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-select',{attrs:{\"clearable\":\"\",\"placeholder\":\"请选择\"},on:{\"change\":function($event){_vm.changeResource(scope.row)}},model:{value:(scope.row.resourceId),callback:function ($$v) {_vm.$set(scope.row, \"resourceId\", $$v)},expression:\"scope.row.resourceId\"}},_vm._l((scope.row.resourceList),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.id}})}))]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"number\",\"label\":\"申请数量\",\"width\":\"180\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"placeholder\":\"请输入\",\"type\":\"number\"},model:{value:(scope.row.number),callback:function ($$v) {_vm.$set(scope.row, \"number\", $$v)},expression:\"scope.row.number\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"180\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){_vm.delItem(scope.$index)}}},[_vm._v(\"删除\")])]}}])})],1),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-left\":\"30px\",\"margin-top\":\"15px\"},attrs:{\"type\":\"primary\",\"icon\":\"el-icon-plus\"},on:{\"click\":_vm.addItem}},[_vm._v(\"添加资源\")])],1):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2cfa3cb0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/activity/edit.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2cfa3cb0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!sass-resources-loader?{\\\"resources\\\":\\\"E:\\\\\\\\czy-activity\\\\\\\\activity-management-platform\\\\\\\\src\\\\\\\\assets\\\\\\\\sass\\\\\\\\index.scss\\\"}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./edit.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./edit.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./edit.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2cfa3cb0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./edit.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2cfa3cb0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/activity/edit.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}